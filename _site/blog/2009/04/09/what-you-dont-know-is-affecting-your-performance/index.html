<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>What you don't know is affecting your performance | Flatterline</title>
    <meta name="description" content="">

    <link href='http://fonts.googleapis.com/css?family=Lato:300,400|Linden+Hill' rel='stylesheet' type='text/css'>
    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css" />
    <link href="/stylesheets/print.css" media="print" rel="stylesheet" type="text/css" />
    <!--[if IE]>
        <link href="/stylesheets/ie.css" media="screen, projection" rel="stylesheet" type="text/css" />
    <![endif]-->

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.0/jquery.min.js"></script>
  </head>

  <body>
    <div class="container">
      <header class="row">
        <div id="title" class="span7">
          <a href="/" title="Flatterline Homepage">Flatterline</a>
        </div>

        <div class="span7"><nav>
  <ul class="tabs">
    <li class="dropdown" data-dropdown="dropdown">
      <a href="#" class="dropdown-toggle">Services</a>
      <ul class="dropdown-menu">
        <li><a href="/services/ruby-on-rails-development/">Ruby on Rails Development</a></li>
        <li><a href="/services/code-audits/">Code Audits</a></li>
        <li class="divider"></li>
        <li><a href="/services/search-engine-marketing/">Search Engine Marketing</a></li>
      </ul>
    </li>
    <li><a href="/portfolio/">Portfolio</a></li>
    <li><a href="/team/">Team</a></li>
    <li><a href="/blog/">Blog</a></li>
  </ul>
</nav>
</div>

        <div class="contact span2">
          <a href="/contact" class="success orange btn">Contact Us</a>
        </div>
      </header>

      <div id="content" class="row">
        <div class="span11">
  <article id="post">
    <header class="row">
      <div class="posted-on" >
        <time datetime="2009-04-09" pubdate="pubdate">April 09, 2009</time>
        
      </div>

      <h1 class="title">
        <a href="" title="Permalink for What you don't know is affecting your performance">What you don't know is affecting your performance</a>
      </h1>

      <h2 class="byline">
        by
        <a href="">Chris Chandler</a>
      </h2>
    </header>

    <div id="post-body">
      

      <p>Does your Linux-based virtualized hosting feel a little slow? Does it suffer from preemptive swapping? Here's a quick tip on getting some more performance out of your current setup. This is especially useful if you have a significant ratio of physical RAM to in-memory programs.</p>

<h3>Swappiness</h3>

<p>The Linux 2.6 kernel has a parameter called vm.swappiness that regulates the kernel's likelihood to swap memory to disk (e.g., to free up memory for disk/content caching, load other programs, etc). Valid values are between 0 and 100. On the current release of Ubuntu (Intrepid) this value has a default value of 60 that you can investigate with the following command:</p>

<pre><code>$ cat /proc/sys/vm/swappiness
60
</code></pre>

<p>This value is generally fine, but if your physical memory is significantly higher than what you need it's worth investigating other choices.I personally find a pretty significant performance increase in Rails behavior with a value of 0; essentially telling the kernel to not swap anything out until it becomes absolutely necessary.</p>

<p>The value can be changed either with:</p>

<pre><code>$ sysctl vm.swappiness=0
</code></pre>

<p><strong>or</strong></p>

<pre><code>$ echo 0 &amp;gt; /proc/sys/vm/swappiness
</code></pre>

<h3>A persistent lack of swappiness</h3>

<p>If you restart the server, then your change will be lost. If you want the change to remain persistent across restarts you'll either need to create a script that calls one of these commands or edit /etc/sysctl.conf to specify the swappiness. As always, exercise caution playing with kernel parameters :-).</p>

<h3>Swapping it back in</h3>

<p>If you change vm.swappiness and want to force the kernel to swap everything back in you can temporarily disable the swap partition and then immediately re-enable it.</p>

<pre><code>$ swapon -s

Filename         Type      Size  Used  Priority
/dev/sda2         partition    524280 33948  -2

$ swapoff /dev/sda2
$ swapon /dev/sda2
</code></pre>

<p>If the machine doesn't have enough memory to accommodate the swap-in the command will fail with an error.</p>

<p><strong>Let us know if this helps you out!</strong></p>

    </div>

    <footer>
      <div class="author">
  <h3>About the Author</h3>
  <div class="vcard row">
    
      <div class="span2 center">
        <img class="photo" src="/images/chris-chandler.jpg" title="Chris Chandler" alt="Chris Chandler" width="80" height="80" />
      </div>
    

    <div class="note span9"><p><a href="/team/chris-chandler">Chris</a> co-founded Flatterline, a <a href="http://flatterline.com/">Ruby on Rails development company</a> in 2009. He has extensive experience in security, algorithms, e-commerce and infrastructure engineering. He's currently employed as an infrastructural engineer at Square in San Francisco.</p></div>
  </div>
</div>

      <div id="related-posts">
  <h3>You might also be interested in:</h3>

  <ul>
    
      <li>
        <a href="/blog/2009/04/09/what-you-dont-know-is-affecting-your-performance">What you don't know is affecting your performance</a>
      </li>
    
      <li>
        <a href="/blog/2009/04/23/disposable-proxy-for-secure-coffee-shop-browsing">Disposable proxy for secure coffee shop browsing</a>
      </li>
    
      <li>
        <a href="/blog/2009/04/27/optimizing-hardware-costs-for-amazon-ec2">Optimizing hardware costs for Amazon EC2</a>
      </li>
    
  </ul>
</div>

    </footer>
  </article>
</div>

<aside id="sidebar" class="span4 offset1">
  <div id="recent-posts">
    <h3>Recent Posts</h3>
    <ul>
      
        <li>
          <a href="/blog/2009/11/11/developer-ignite-phoenix-real-world-cryptography">Developer Ignite Phoenix: Real World Cryptography</a>
        </li>
      
        <li>
          <a href="/blog/2009/06/20/desert-code-camp-followup">Desert Code Camp Followup</a>
        </li>
      
        <li>
          <a href="/blog/2009/06/09/desert-code-camp">Desert Code Camp</a>
        </li>
      
        <li>
          <a href="/blog/2009/05/03/2009-04-30-recap-of-phoenix-opencoffee-club">2009-04-30: Recap of Phoenix OpenCoffee Club</a>
        </li>
      
        <li>
          <a href="/blog/2009/04/27/optimizing-hardware-costs-for-amazon-ec2">Optimizing hardware costs for Amazon EC2</a>
        </li>
      
    </ul>
  </div>
</aside>

      </div>

      <footer>
        <div id="company-info" class="row">
          <div class="vcard span12">
            <div class="adr">
              <a class="fn org url" href="http://flatterline.com/">Flatterline</a>
              <div class="tag-line">Purveyors of Kick Ass Web Development</div>
            </div>
          </div>

          <p class="span4 center">
            <a href="/contact/">Contact us.</a> â€¢
            <a class="value" href="tel:+14804209081">480.420.9081</a>
          </p>
        </div>

        <div id="copyright" class="row">
          <div class="span2 center">
            <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">
              <img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-nc-sa/3.0/80x15.png" />
            </a>
          </div>

          <div class="span10">
            <a xmlns:cc="http://creativecommons.org/ns#" href="http://flatterline.com/" property="cc:attributionName" rel="cc:attributionURL">Flatterline.com</a>
            is licensed under a
            <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">
              Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License
            </a>.
          </div>
        </div>
      </footer>
    </div>

    <script src="/javascripts/bootstrap-dropdown.js"></script>
    <script src="/javascripts/application.js"></script>
  </body>
</html>
